const acoes_b3 = ['ABTT34','ABBV34','ABCB10','ABCB2','ABCB1','ABCB3','ABCB9','ABCB4','ABNB3','ABRE3','ABRE4','ABRE11','ABYA1','ABYA9','ABYA3','ACNB34','EALT3','EALT4','AVIL3','ATVI34','ACGU3','ADBE34','ADHM3','AELP3','AESL3','AESL4','TIET1','TIET2','TIET12','TIET11','TIET4','TIET3','GETI3','GETI4','AETA3','AETB34','AFLU3','AFLU5','AFLU6','AFLT3','ANDG4B','CANT3B','CANT4B','AGIN3','AGEI3','AGEN11','AGEN33','AIGB34','AALC34','BRGE3','BRGE5','BRGE6','BRGE7','BRGE8','BRGE11','BRGE12','CRIV3','CRIV4','RPAD3','RPAD5','RPAD6','BRIV3','BRIV4','ALSC3','ALSC9','ALSC1','APTI3','APTI4','ALIU3B','ALLL12','ALLL3','ALLL4','ALLL11','AORE3','AALR3','ALPA3','ALPA4','APER3','GOGL34','GOGL35','ALTR3','MOOO34','ALTS11','ALTS3M','ALTS3','ALUP2','ALUP1','ALUP13','ALUP12','ALUP3','ALUP9','ALUP4','ALUP10','ALUP11','AMZO34','TMAC11B','TMAC5B','TMAC7B','TMAC3B','TMAC6B','TMAC8B','BAZA3','ABEV9','AMBV2','ABEV1','AMBV1','ABEV3','AMBV3','AMBV9','AMBV4','AMBV10','AALL34','AXPB34','AMCE1','AMCE11','AMCE3','AMCE9','AMCE12','AMCE6','AMGN34','AMIL3','CBEE1','CBEE3','AMPI3','ANDV34','AEDU9','AEDU3','AEDU4','AEDU12','AEDU11','ANIM3','AAPL34','APTV34','ARCZ3','ARCZ5','ARCZ6','VDNP3B','ARMT34','ARNC34','ARZZ3','AWII34','ATBS3','ARTR3','ARLA3','ARLA4','TT023','TT043','TT013','TT033','ATOM3','ATTB34','ADPR34','AUTM3','AZOI34','AVON34','AZEV3','AZEV4','AZUL4','BTOW3','BTOW1','BTOW9','B3SA3','BAHI3','BAHI4','CBAG9','CBAG3','BIDI10','BPAN2','BPAN3','BPAN9','BPAN10','BPAN12','BGIP3','BGIP4','BEES1','BEES3','BEES9','BEES4','BOAC34','BPAR3','BRSR3','BRSR5','BRSR6','BSAN33','BSAN30','BDLL3','BDLL4','BTTL10','BTTL9','BTTL1','BTTL2','BTTL3','BTTL4','BALM9','BALM3','BALM4','BALM10','BBSD11','BBML3','BBSE3','IDVL3','IDVL4','BPAN4','BPAN14','PINE9','BDRU11','PBEL3B','BEMA3','BERK34','BSCT3','BSCT14','BSCT11','BSCT5','BSCT12','BSCT15','BSCT16','BSCT13','BSCT6','BBYY34','BETP3B','BHGR1','BHGR9','BHGR3','BMKS3','BICB3','BICB4','BIIB34','BIOM2','BIOM1','BIOM3','BIOM3M','BIOM9','BIOM9M','BIOM10','BIOM4','BSEV1','BSEV3','BSEV9','GBIO33','BKBR3','BLAK34','BVMF3','BONY34','BOEI34','BOBR11','BOBR3','BOBR4','BNPA3B','BKNG34','BOXP34','BBRK1','BBRK9','HCBR3','HCBR1','BRIN9','BRIN1','BRIN3','BRML3','BPHA1','BPHA11','BPHA9','BRPR3','BBDC2','BBDC1','BBDC3','BBDC9','BBDC10','BBDC4','BRAP3','BRAP4','BBAS13','BBRK3','BBAS11','BBAS3','BBAS12','BBAS9','BBAS15','BRTP3','BRTP4','BRTO3','BRTO4','BTUR3','AGRO3','BRKM11','BRKM1','BRKM3','BRKM9','BRKM5','BRKM12','BRKM6','BMTO3','BMTO4','BPHA3','BFRE3','BFRE11','BFRE12','BFRE4','BSLI3','BSLI4','BRFS3','BMYB34','AVGO34','BISA1','BISA3','BISA9','BRQB3','BRZI3B','BBTG12','BBTG35','BBTG33','BBTG13','BBTG36','BBTG99','BBTG11','BTCR12','BPAC11','BPAC3','BPAC5','BUET3','BUET4','DHBI3','DHBI4','OPDL3B','DHER34','DASA3','DASA9','DVAI34','DAYC11','DAYC3','DAYC9','DAYC4','DAYC10','DEEC34','DELL34','DEAI34','XRAY34','DVIX3','DVIX3M','DBAG34','DASA1','PNVL3','PNVL4','DNEN3B','DIRR3','LOGG9','AHEB13','AHEB1','AHEB11','DCVY34','DXTG3','DXTG4','IMBI1','IMBI3','IMBI4','DOCA3','DOCA4','DOHL3','DOHL4','DGCO34','DLTR34','DMMO3','DMMO11','DMMO1','DOMC11','DOMO3','DOWB34','DWDP34','DROG3','DTCY1','DTCY9','DTCY3','DTCY4','DAGB11','DAGB33','DUFB11','DUKB34','DUPO34','DDNB34','DTEX9','DTEX1','DTEX11','DTEX3','DXXI8','DXXI7','EBAY34','EBXB3','ECOD1','ECOD9','ECOD3','ECOR3','EAIN34','ELEK3','ELEK4','EKTR3','EKTR4','ELET11','ELET1','ELET3','ELET9','ELET5','ELET6','ELET12','ETRO3B','LIPR1','LIPR3','ELPL1','ELPL3','ELPL4','ELPL5','ELPL6','ELUM3','ELUM4','EMAE3','EMAE4','EMBR3','EBTL9','EBTP2','EBTP1','EBTP3','EBTP4','EMCC34','ENAT3','ECPR3','ECPR4','ENBR1','ENBR3','ENBR9','CPRE1','ENGI2','ENGI12','ENGI13','ENGI15','ENGI14','ENGI1','ENGI10','ENGI9','ENMT1','ENMT10','ENMT2','ENMT9','ENMT3','ENMT4','ENGI3','ENGI4','ENGI11','ENEV1','ENEV9','ENEV3','EGIE3','EQTL1','EQTL3','EQIX34','BPIA3','ESTC3','ELCI34','ESTR3','ESTR4','ETER1','ETER3','ETER9','EUCA3','EUCA4','EVEN3','BAUH9','BAUH3','BAUH4','BAUH10','EXGR34','ESRX34','EXXO34','EZTC3','FGUI3','FGUI4','TOUR12','TOUR11','TOUR13','FTRX3','FTRX4','FBOK34','FASL34','XBOV11','KNCR12','FIIB11','AEFI11','AGCX11','BNFS11','BBPO11','BPFF11','FIXX11','RBBV11','JPPC11','KNCR11','FMOF11','MBRF11','PABY11','PLRI11','RBDS11','FFCI11','RBCB11','RNGO11','RBVO11','SAAG11','SDIL11','WPLZ11','TBOF11','ONEF11','XTED11','XPCM11','ESUD11','ESUT11','ESUD12','ESUT12','ESUU12','FVPQ11','FDXB34','FMXB34','VSPT1','VSPT3','VSPT4','FHER1','FHER3','FHER9','FESA3','FESA4','GASC3B','GASC4B','FRRN3B','FRRN6B','FRRN5B','ENSP11','SINQ11','SING11','SINC11','FAGO3B','FBMC3','FBMC4','FIBR3','FFTD34','MALL11','FPAB11','ABCP11','ABCP12','BPFF12','ALZR11','ALZR12','FAED11','AQLL11','ATCR11','BVAR11','BBRC11','RDPD11','RNDP11','BBIM11','BBVJ11','BCFF11','BCFF12','BRCR11','BRCR12','BCIA11','BCIA12','BCRI11','BCRI12','THRA11','BMII11','BZLI11','BTCR11','BTGM11','CBOP11','CTXT11','FCFL11','FCAS11','CNES11','CEOC11','HCRI11','CSBC11','CSBC12','HGCR11','HGJH11','HGLG11','HGRU11','ATSA11','FOFT11','HGPO11','CXRI11','CXTL11','PQDP11','CARE12','CARE11','DAMT11','FISD11','span','EURO11','KINP11','FEXC11','VRTA11','VRTA12','VRTA13','FLRP11','EDGA11','GVFF12','FIGS11','GSFI11','GGRC11','RCFA11','NCGR11','GWIC11','GWIR11','HUSC11','HBTT11','HFOF11','span','HMOC11','HGRE13','HGBS11','SHPH11','SHPH12','HTMX11','FIIB13','FIIB12','FINF11','IRDM11','FJKI11','JSRE12','BJRC12','BJRC11','JSIM11','JSRE11','JTPR11','KNRI11','KNHY11','KNIP11','MSHP11','NSLU11','GRLV11','DMAC11','MALL12','MAXR11','MXRF15','MXRF16','MXRF12','MXRC11','FLCI11','MFII13','MFII41','MGFF12','MGFF11','PRTS11','SHOP11','NCHB11','NPAR11','NVHO11','OUJP11','OUJP12','OUCY11','ORPD11','PRSV11','PATC11','FPNG11','VPSI11','PBLV11','RBRD11','RBPR11','RBPD11','RBPD13','RBPD12','RBRY11','RBRP11','RBRF11','RBAG12','RBAG11','RBRR11','RDES11','REIT11','RCCS11','RBED11','FFCI12','RBVA11','FLMA11','SAAG12','STFI11','SFND11','FISC11','SCPF11','SDIL12','JRDM11','FSIG11','SPTW11','SPAF11','STRX11','TSFI11','TSFI12','TGAR11','TFOF11','ALMI11','TRNT11','TSNC11','TRXL15','TRXL12','UBSR13','UBSR11','RECT11','URBN11','VOTS11','FVPQ12','VGIR11','FVBI11','LVBI11','VERE11','FIVN11','VISC11','VISC12','VTLT11','VSHO11','VLJS12','VLJS11','XPGA11','XPIN11','XPLG11','XPLG12','XPML11','FNAM11','FNCN3','FNOR11','BKOI11','BRCP11','FCCQ11','ESUU11','NVRP11','FPOR11','XPOM11','FSLR34','FSRF11','FSPE11','FSTU11','FLTC34','FLRY3','FLEX3','FLYN3B','FDMO34','FJTA14','FJTA18','FJTA12','FJTA16','FJTA10','FJTA9','FJTA11','FJTA15','FJTA13','FJTA17','FJTA3','FJTA4','FOMS3','FPRT3B','FPRT4B','FFTL3','FFTL4','FRAS3','FRAS4','FCXO34','FDES11','RBRR12','TORM13','FRES11','FTRT3B','HBTS3','HBTS5','HBTS6','HAGA3','HAGA4','HALI34','THGI34','HAPV3','HPIA3','HFOF13','HBOR1','HBOR3','HBOR9','HETA3','HETA4','PARD3','HSHY34','HGRE11','HOME34','HONB34','HOOT3','HOOT4','HPQB34','HRTP1','HRTP11','HRTP3','HRTP9','HYPE12','HYPE3','IBMB34','IBXL11','IBXX11','ICON11','IDNT1','IDNT3','IDNT9','IEEX11','IENG3','IENG5','IENG6','IFNC11','IGCX11','IGSN3','IGUA3','IGUA5','IGUA6','IGTA3','IMCH3','MEAL1','MEAL3','MEAL9','IMOB11','VGIR12','IBOV11','CATA3','CATA4','IFIX11','IGCT11','JBDU1','JBDU2','IGNM11','ROMI3','INDX11','IDVL9','IDVC9','IDVL2','IDVL11','IDVL12','IDVL10','IDVL1','INEP1','INEP2','INEP3','INEP9','INEP4','INEP10','INET1','INET3','INPR3','ITLC34','BIDI4','BIDI11','BIDI2','INNT3','GNDI3','INTU34','IVPR3B','IVPR4B','ISBC34','FIGE3','FIGE4','IVTT3','IVTL3B','MYPK1','MYPK11','MYPK12','MYPK3','IRBR3','IRON3','SMAL11','ECOO11','BRAX11','CSMO11','MILA11','MOBI11','UTIP11','IMAT11','IBRA11','IDIV11','BOVA11','UTIL11','ISEE11','BOVV11','DIVO11','FIND11','GOVE11','MATB11','ISUS11','PIBB11','SPXI11','ITAG11','SQRM3','SQRM11','ITAU3','ITAU4','ITSA1','ITSA2','ITSA3','ITSA9','ITSA4','ITSA10','ITEC11','ITEC3','ITUB3','ITUB4','IVBX11','JBDU12','JBDU11','JBDU3','JBDU9','JBDU4','JBDU10','JCPC34','JBSS11','JBSS1','JBSS3','JBSS9','JPSA4','JPSA3','MLFT3','MLFT4','JHSF3','JHSF9','JHSF1','JFEN1','JFEN3','JFEN9','JNJB34','JOPA3','JOPA4','JPMC34','JSLG3','CTKA1','CTKA10','CTKA2','CTKA9','CTKA3','CTKA4','KMPR34','KEPL11','KEPL3','KMBB34','KMIC34','KFOF11','KNRE11','KLBN13','KLBN3','KLBN4','KLBN11','KSSA3','KHCB34','KFGI34','KROT1','KROT12','KROT2','KROT3','KROT9','KROT4','KROT10','KROT13','KROT11','LBRN34','LFFE3','LFFE4','MILK11','MILK33','MEOP3B','LATM11','LARK3','LARK4','LATM33','LATM12','LLIS3','LECO3','LECO4','MAGG3L','PITI3','PITI4','MLPP3M','MLPP3','LBRD34','LSXM34','BITY3B','LIGT3','LILY34','LNKD34','LINX3','LIQO3','LTEL3B','LTEL11B','LTEL5B','LGLO3','LGLO4','LIXC3','LIXC4','LLXL1','LLXL3','LLXL9','RENT3','LCAM3','LMTB34','LOGG1','LOGG3','LOGN12','LOGN9','LOGN1','LOGN3','LAME15','LAME3','LAME4','LAME11','LHER3','LHER4','AMAR3','LREN3','LREN11','SPRT3B','LPSB1','LPSB9','LOWC34','LPSB3','LUPA11','LUPA12','LUPA1','LUPA3','LUPA9','RHDS3','MDIA3','MACY34','MSRO3','MGLU3','MAGG1','MAGG9','MAGG3','MNBI7','MGEL3','MGEL4','MAOR3B','MAOR4B','CTPC3','POMO2','POMO3','POMO4','POMO10','MRFG11','MRFG3','MARI3','MRSL3','MRSL4','MKLC34','MARL3B','MARL4B','MRLM4B','MRLM3B','MSCD34','MXRF11','MCDC34','MEDI3','MDTC34','MSPA3','MSPA4','MLPA11','MLPA3','MLPA12','MLPA4','MEND3','MEND5','MEND6','MNZC3B','BMEB10','BMEB1','BMEB2','BMEB9','BMEB3','BMEB4','BMEB11','MERC9','MERC10','MERC1','MERC2','MERC3','MERC4','BMIN1','BMIN3','BMIN4','BMIN10','BMIN9','MELI34','MRCK34','MFII11','DUQE3','DUQE4','MTIG1','MTIG2','MTIG9','MTIG3','MTIG10','MTIG4','LEVE1','LEVE3','LEVE4','FRIO1','FRIO3','FRIO9','MTSA3','MTSA4','METB34','OPRT3B','MCOM4','MUTC34','MSFT34','MLCX11','TIBR3','TIBR5','TIBR6','MILS1','MILS3','MILS9','MMAQ3','MMAQ4','BEEF1','BEEF11','BEEF9','BEEF3','MIBV11','MNPR1','MNPR3','MNPR9','MMXM1','MMXM3','MMXM9','MMXM11','MOEP3B','MDLZ34','MSTO34','MOAR1','MOAR3','MOAR9','MONP3B','MCOR34','MSBR34','MOSC34','MOVI1','MOVI3','MOVI9','MPEX1','MPXE11','MPXE1','MPXE9','MPXE99','MPXE99S','MPXE99D','MPXE99T','MRSA5B','MRSA3B','MRSA6B','MRVE99','MRVE3','MULT9','MULT1','MULT3','MPLU3','MPLU11','MNDL12','MNDL11','MNDL1','MNDL3','MNDL9','MNDL4','NAFG3','NAFG4','NATU3','GNAN3B','NETC3','NETC1','NETC9','NETC4','NETC10','NETC2','NFLX34','NEWT3B','NEXT34','NIKE34','BNBR3','BNBR4','NORD3','NRTQ3','NRTQ3M','NOCG34','BNCA3','NOVA4B','NOVA3B','OGSA3','NVML3B','NVMP3B','NUTR1','NUTR3','NVDC34','OXYP34','ODER3','ODER4','ODPV3','OPOE3B','OGSA1','OGSA9','OGXP3','OHLB3','OIBR9','OIBR1','OIBR11','OIBR3','OIBR4','OIBR99','OMGE3','ALEF3B','OPGM3B','OPHE3B','OPSE3B','ORCL34','ORLY34','OSXB1','OSXB3','OSXB9','OFSA3','PCAR2','PCAR11','PCAR3','PCAR4','PCAR5','PCAR12','PCAR13','PACF3','PREB32','PREB11','BPNM9','BPNM10','BPNM2','BPNM1','BPNM3','BPNM4','PATI9','PATI10','PATI1','PATI2','PATI3','PATI4','PEAB3','PEAB4','PRBC2','PRBC10','PRBC3','PRBC4','PMAM3','PMAM4','PCPA4B','PCPA3B','PARC3','LCSA3','LCSA4','BPAT33','BPAT11','PYPL34','PDGR12','PDGR9','PDGR11','PDGR3','PDGR1','PEPB34','PRGA3','RPMG2','RPMG1','RPMG3','RPMG4','PETR4','BRDT3','PETR3','PTPA2','PTPA1','PTPA3','PTPA9','PTPA4','PTPA10','PQUN3','PQUN4','PRIO3','PTNT3','PTNT4','PFIZ34','PGCO34','PHMO34','PINE2','PINE1','PINE3','PINE4','PINE10','PLAS3','PLAS11','PLAS1','PNCS34','PORD11','PPAR3','FRTA3','FRTA9','FRTA1','PSSA3','PSSA11','PSVM11','PTBL3','PRTX3','POSI3','PPLA36','PPLA35','PPLA11','PQTM1','PQTM9','PQTM3','PQTM4','PTCA3','PTCA11','PRCA3','PRCA12','PRCA11','PRNR3','PRVT3B','PMET3','PMET5','PMET6','PFRM9','PFRM1','PFRM3','PRMN3B','PRPT3B','PNOR3','PNOR5','PNOR6','PRVI3','PRML9','PRML1','PRML3','QGEP3','QGNP4B','QGNP3B','QCOM34','QUAL3','QUSW3','RAIA3','RADL3','RAPT2','RAPT9','RAPT1','RAPT10','RAPT3','RAPT4','RSIP3','RSIP4','RBGS11','RBCS3B','RBRF12','FRBR11','RCSL2','RCSL1','RCSL3','RCSL9','RCSL4','RCSL10','REDE1','REDE2','REDE3','REDE9','REDE4','REDE10','RDCD3','RDTR3','REGN34','RNAR1','RNAR9','RNAR3','RNPT3','RNPT4','RNEW13','RNEW1','RNEW2','RNEW12','RNEW3','RNEW9','RNEW4','RNEW10','RNEW11','OPRE3B','REEM3','REEM4','RBRA3B','RSUL3','RSUL4','RJCP1','RJCP3','RJCP11','RJCP9','RLOG9','RDNI3','ROST34','RSID1','RSID3','RSID11','RSID9','RAIL3','RUMO1','RUMO3','RUMO9','SBSP3','SDIA3','SDIA4','SAGP3B','SSFO34','FCAP3','FCAP4','SANC34','SAPR3','SAPR4','SAPR2','SAPR11','SNSY3','SNSY5','SNSY6','SANB12','SANB3','SANB4','SANB10','SANB11','CTSA3','CTSA4','CTSA8','STBP3','STBP4','STBP11','SCAR3','SMTO11','SMTO3','TELB2','BDRT11','CEEB11','INEP12','EURO12','CEEB1','CEEB13','INEP11','STFM11','SLED3','SLED4','PSEG3','PSEG9','PSEG4','PSEG10','SCLO3','SCLO4','SLBG34','SHUL3','SHUL4','SCHW34','SEBB3','SEBP3','SEBB4','SEBB11','DURA4','SATI3','DURA3','CSAB3','CSAB4','CSMB3','SLCT3B','SEMP3','SNSL3','SNSL3M','SEER1','SEER9','SEER3','SGEN3','SGEN4','SETI3B','SHOW3','CSNA3','SSBR3','SBNY34','SIMN34','SQIA3','SRXM34','SLCE3','SMLL11','SMFT3','SMFT14','SMFT13','SMFT15','SMFT6','SMFT11','SMFT12','SMLS3','SMLE3','SFSA2','SFSA3','SFSA4','SFSA10','SEDU3','SOND3','SOND5','SOND6','CRUZ3','SPGI34','SPRI3','SPRI5','SPRI6','SGPS1','SGPS3','SGPS9','SPRN34','span','AHEB3','AHEB5','AHEB6','STTR3','SBUB34','STRP3','STRP4','STKF3','STLB1','STLB3','SLBC34','OPTS3B','SULA3','SULA4','SULA11','SULT3','SULT4','NEMO11','NEMO1','NEMO13','NEMO3','NEMO4','NEMO5','NEMO6','SUZB3','SUZB11','SUZB12','SUZB5','SUZB6','SUZB99','SZPQ3','SZPQ4','SWET3','SWET1','SWET9','TAMM1','TAMM9','TAMM3','TAMM4','TPRY34','TGTB34','TARP11','TRPN9','TRPN1','TRPN3','FJTA2','FJTA1','TENE3','TENE5','TENE6','TENE7','TOYB1','TOYB2','SJOS3','SJOS4','TECN3','TCSA9','TCSA1','TCSA3','TCNO1','TCNO3','TCNO9','TCNO4','TOYB13','TOYB3','TOYB9','TOYB4','TOYB10','TGMA3','TEKA1','TEKA2','TEKA3','TEKA9','TEKA4','TEKA10','TKNO3','TKNO4','TNCP1','TNCP2','TNCP3','TNCP4','TELB1','TELB3','TELB9','TELB4','VIVT3','VIVT4','TEFC11','TNLP2','TNLP1','TMAR1','TMAR12','TMAR11','TMAR3','TMAR9','TMAR13','TMAR5','TMAR6','TNLP3','TNLP9','TLMP3','TNLP10','TNLP4','TMGC3','TMGC6','TMGC7','TMGC8','TMGC11','TMGC12','TMGC13','TMCP3','TMCP4','TLPP3','TLPP4','TLVT3B','TEMP3','TEND3','TERI1','TERI3','TERI9','TRNA3','TRNA4','TRNA11','TESA1','TESA3','TESA9','TSLA34','TSOR34','IPNN3','TXRX3','TXRX4','TEXA34','TGLT32','TGLT11','TMOS34','TIFF34','TIMP3','TCSL1','TCSL2','TCSL3','TCSL4','TIMP4','TWXB34','TVIT3','TJXC34','TOTS3','TBLE3','TRFO3','TRFO4','TRPL2','TRPL1','TRPL3','TRPL9','TRPL4','TRPL10','TAEE3','TAEE4','TAEE11','RIGG34','TRVC34','LUXM3','LUXM4','TRIS3','TPIS9','TPIS1','TPIS3','TROR3','TROR4','TRXL11','TUPY3','TUPY4','TWTR34','TSNF34','UBSR12','UBSG34','UGPA3','UGPA4','UBHD3','UBHD6','UBBR3','UBBR4','UBBR11','UCAS3','UNID3','UPAC34','UNIP3','UNIP5','UNIP6','UTEC34','UNHH34','UOLL3','UOLL4','UPSS34','UPKP3B','USBC34','USSX34','USIM9','USIM11','USIM1','USIM12','USIM3','USIM5','USIM6','UCOP3','UCOP4','WALM34','WALG34','WGBA34','DISB34','WATC34','WEGE3','WFCO34','WMBY3','WABC34','WUNI34','MWET3','MWET4','WHRL3','WHRL4','WISA3','WISA4','WSON33','WSON11','WIZS3','WLMM3','SGAS3','WLMM4','SGAS4','WWOW3','XRXB34','XPTD11','XPHT11','XPHT12','XPML12','YPFL3','ILMD9','ILMD3','ILMD10','ILMD4','ILMD2','ILMD1','YUMR34','OPZI3B','ZURI9','MMMC34','QVUM3B','QVQP3B']

let count = 0
const stockNodes = []

const walkThrought = (node) => {
  count = count + 1

  if (node.children.length) {
    Array.prototype.forEach.call(node.children, walkThrought)
  }

  const acao = acoes_b3.find(acao => node.textContent.indexOf(acao) >= 0)

  if (
      [Node.ELEMENT_NODE, Node.TEXT_NODE].includes(node.nodeType) &&
      node.textContent.length <= 1000 &&
      !stockNodes.find(stockNode => node.contains(stockNode)) &&
      acao
  ) {
    node.dataset.acao = acao
    stockNodes.push(node)
  }
}

walkThrought(document.body)

stockNodes.forEach(el => {

  el.setAttribute('style', `position:relative;${el.style}`)

  el.onmouseenter = function(event) {

    const acao = el.dataset.acao
    const div = document.createElement('div')

    div.onmouseleave = event => {
      const tooltip =  el.querySelector('.acao-tooltip')
      if (tooltip instanceof HTMLElement) {
        tooltip.remove()
      }
      el.loading = false
    }

    if (el.loading) {
      return event.preventDefault()
    } else {
      const tooltip =  el.querySelector('.acao-tooltip')
      if (tooltip instanceof HTMLElement) {
        tooltip.remove()
      }
      el.loading = true
    }

    fetch(`https://acoes-br.herokuapp.com/${acao}`).then(res => {
      res.json().then(data => {
        div.classList.add('acao-tooltip')
        div.setAttribute('style', `position:absolute;display:block;background:#fff;z-index:99999;left:-10px;top:-40px;border-radius:4px;box-shadow: 0px 0px 34px 0px rgba(0,0,0,0.3);`)
        
        div.innerHTML = `
          <div style="padding:10px;width:100%;height:100%;box-sizing:border-box;">
            <span>${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(data.meta.chartPreviousClose)}</span>
          </div>
        `
  
        this.appendChild(div)
  
        el.loading = false
      })
    }).catch(error => {
      el.loading = false
    })
  }
  
  el.onmouseleave = event => {
    const tooltip =  el.querySelector('.acao-tooltip')
    if (tooltip instanceof HTMLElement) {
      tooltip.remove()
    }
    el.loading = false
  }
})
